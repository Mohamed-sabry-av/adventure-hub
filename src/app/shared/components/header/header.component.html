<!-- Placeholder only shown when header is fixed and not on product page -->
<div *ngIf="isFixed && !isProductPage && lastScrollY > 0" [style.height.px]="headerHeight"></div>

<header
  class="w-full transition-all duration-300 ease-in-out header-element"
  [class]="{'is-scroll': lastScrollY !== 0 && currentPage !== 'checkout' && !isProductPage, 'fixed top-0 left-0 z-50': isFixed && !isProductPage, 'relative': isProductPage || currentPage === 'checkout'}"
  #headerEl
>
  @if (currentPage === 'checkout') {
  <div
    class="h-[135px] w-full bg-white border-b relative flex items-center justify-center"
  >
    <a class="block" [routerLink]="''">
      <img
        src="header/adv-hub-logo-n_cropped.png"
        alt="Adventures hub logo"
        routerLink="/home"
        class="w-[200px] h-10 lg:w-[250px] lg:h-12 cursor-pointer"
        loading="lazy"
      />
    </a>
    <i class="pi pi-shopping-bag bag-checkout" [routerLink]="['cart']"></i>
  </div>
  } @else {
  <!-- Secondary Info -->
  @if (lastScrollY === 0) {
  <div
    class="relative mt-2 border-b md:border-0 px-4 text-white flex items-center overflow-hidden h-6"
  >
    <p class="absolute top-0 w-full text-center text-sm animate-slide-first">
      <strong>Free Delivery</strong> for orders over AED 100
    </p>
    <p class="absolute top-0 w-full text-center text-sm animate-slide-second">
      Buy Now & Pay Later with <strong>Tabby</strong>
    </p>
  </div>
  }

  <!-- Main Info -->
  <app-app-container>
    <div class="py-3 flex items-center justify-between">
      <div>
        <i
          class="pi pi-bars ripple-effect"
          (click)="onSiwtchSideNav(true)"
          *ngIf="(sidenavIsVisible$ | async) === false"
        ></i>
        <i
          class="pi pi-times pi-sidenav ripple-effect"
          (click)="onSiwtchSideNav(false)"
          *ngIf="(sidenavIsVisible$ | async) === true"
        ></i>
      </div>

      <!-- Logo -->
      <a class="block">
        <img
          src="header/White logo-01.webp"
          alt="Adventures hub logo"
          routerLink="/home"
          class="w-[200px] h-10 lg:w-[250px] lg:h-12 cursor-pointer"
          loading="lazy"
        />
      </a>

      <!-- Search -->
      <div class="flex-1 md:block hidden">
        <app-search-bar />
      </div>

      <!-- Icons -->
      <div
        class="col-span-6 md:col-span-2 flex items-center justify-end gap-4 order-2 md:order-3"
      >
        <i
          class="pi pi-times md:hidden block ripple-effect"
          (click)="onShowSearchbar()"
          *ngIf="showSearchbar"
        ></i>
        <i
          class="pi pi-search md:hidden block ripple-effect"
          (click)="onShowSearchbar()"
          *ngIf="!showSearchbar"
        ></i>
        <a routerLink="/user" class="ripple-effect">
          <i class="pi pi-user"></i>
        </a>
        <a routerLink="/cart" class="ripple-effect">
          <i class="pi pi-shopping-bag"></i>
        </a>
      </div>
    </div>
    @if (showSearchbar) {
    <div class="w-full -mt-[10px] md:hidden block z-10 pb-2" @navbarAnimation>
      <app-search-bar />
    </div>
    }
  </app-app-container>

  <div
    @navbarAnimation
    *ngIf="showNavbar && !(isNavbarAnimating$ | async)"
    class="transition-transform duration-300 ease-in-out navbar-wrapper"
    appInViewport
    (visibleInViewport)="onNavbarVisible($event)"
  >
    @defer (on viewport) {
    <app-navbar-container
      [mainCategories]="mainCategories"
      [allCategories]="allCategories"
    />
    }@placeholder{
    <div class="w-full h-[1px] bg-[#717261]"></div>
    }
  </div>
  }
</header>
