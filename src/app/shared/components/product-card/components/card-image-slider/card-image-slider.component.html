<div class="image-slider">
  <!-- Image slider -->
  <div class="slider-container" #sliderContainer [ngClass]="{'hovered': isHovered}" role="region"
    aria-label="Product image slider">
    <!-- Mobile navigation arrows (only show if multiple images) -->
    <div class="mobile-navigation-arrows" *ngIf="isMobile && hasMultipleImages">
      <button class="nav-arrow nav-prev" [disabled]="currentImageIndex === 0" (click)="navigateImages(-1, $event)"
        aria-label="Previous image">
        <span class="arrow-icon" aria-hidden="true">❮</span>
      </button>
      <button class="nav-arrow nav-next" [disabled]="currentImageIndex >= maxImageIndex"
        (click)="navigateImages(1, $event)" aria-label="Next image">
        <span class="arrow-icon" aria-hidden="true">❯</span>
      </button>
    </div>

    <!-- Images -->
    <div class="slide" *ngFor="let image of product?.images; let i = index" [ngClass]="{
        'active': i === currentImageIndex,
        'second-image': i === 1 && isHovered && !isMobile,
        'color-selected': selectedColorIndex === i && selectedColorIndex >= 0
      }" [attr.aria-hidden]="i !== currentImageIndex && !(i === 1 && isHovered && !isMobile)">
      <a [routerLink]="['/product', product.slug]" [attr.aria-label]="'View ' + product.name"
        [class.disable-link-mobile]="isMobile">
        <img [src]="getOptimizedImageUrl(image.src)" loading="lazy" [attr.data-index]="i"
          [alt]="image.alt || product.name" (load)="onImageLoad($event)" />
      </a>
      <!-- Mobile-only product link layer - separate from images to avoid navigation conflicts -->
      <a *ngIf="isMobile" [routerLink]="['/product', product.slug]" class="mobile-product-link"
        (click)="$event.stopPropagation()" [attr.aria-label]="'View ' + product.name"></a>
    </div>

    <!-- Image indicator dots for mobile -->
    <div class="image-indicators" *ngIf="isMobile && hasMultipleImages" role="tablist"
      aria-label="Product image navigation">
      <span *ngFor="let image of product?.images; let i = index" class="indicator-dot"
        [ngClass]="{'active': i === currentImageIndex}" (click)="goToImage(i, $event)" role="tab"
        [attr.aria-selected]="i === currentImageIndex" [attr.aria-label]="'Image ' + (i + 1)"></span>
    </div>
  </div>

  <!-- Product status tags -->
  <div class="product-tags product-tags-bottom-left" aria-label="Product tags">
    <div *ngFor="let tag of getProductTags()" class="tag" [ngClass]="getTagClass(tag)">
      <ng-container *ngIf="tag !== 'HUB'; else hubTag">
        {{ tag }}
      </ng-container>
      <ng-template #hubTag>
        <img src="assets/Hub-logo/black-hub.svg" alt="Hub" class="hub-icon-small" width="16" height="16">
      </ng-template>
    </div>
  </div>
</div>