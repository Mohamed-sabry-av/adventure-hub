<div class="product-description" *ngIf="productAdditionlInfo">
  <!-- Sticky Navigation -->
  <nav class="sticky-tabs" aria-label="Product information tabs">
    <div class="description-tabs" role="tablist">
      <button class="tab-item" [class.active]="activeSection === 'description'" (click)="scrollToSection('description')"
        role="tab" [attr.aria-selected]="activeSection === 'description'" aria-controls="description">
        Description
      </button>
      <button class="tab-item"
        *ngIf="productAdditionlInfo.brand || getAdditionalInfoFromVariations().colors?.length || getAdditionalInfoFromVariations().sizes?.length"
        [class.active]="activeSection === 'additional-info'" (click)="scrollToSection('additional-info')" role="tab"
        [attr.aria-selected]="activeSection === 'additional-info'" aria-controls="additional-info">
        Additional Information
      </button>
      <button class="tab-item" [class.active]="activeSection === 'reviews'" (click)="scrollToSection('reviews')"
        role="tab" [attr.aria-selected]="activeSection === 'reviews'" aria-controls="reviews">
        Reviews <span class="review-count" *ngIf="reviewCount > 0">{{ reviewCount }}</span>
      </button>
    </div>
  </nav>

  <!-- Content Sections -->
  <div class="tab-sections">
    <!-- Description Section -->
    <section id="description" class="content-section" role="tabpanel" aria-labelledby="description-heading"
      tabindex="0">
      <h2 id="description-heading" class="section-header">Description</h2>
      <div *ngIf="safeDescription; else noDescription">
        <div class="raw-description" [innerHTML]="safeDescription"></div>
      </div>
      <ng-template #noDescription>
        <p class="no-description">No description available for this product.</p>
      </ng-template>
    </section>

    <!-- Additional Information Section -->
    <section id="additional-info" class="content-section"
      *ngIf="productAdditionlInfo.brand || getAdditionalInfoFromVariations().colors?.length || getAdditionalInfoFromVariations().sizes?.length"
      role="tabpanel" aria-labelledby="additional-info-heading" tabindex="0">
      <h2 id="additional-info-heading" class="section-header">Additional Information</h2>
      <div class="additional-info-content">
        <table class="info-table">
          <caption class="sr-only">Product specifications and attributes</caption>
          <tbody>
            <!-- Brand -->
            <tr *ngIf="productAdditionlInfo.brand">
              <th scope="row">Brand</th>
              <td>{{ productAdditionlInfo.brand }}</td>
            </tr>

            <!-- Colors -->
            <tr *ngIf="(getAdditionalInfoFromVariations().colors).length > 0">
              <th scope="row">Color</th>
              <td class="color-list">
                <span *ngFor="let color of getAdditionalInfoFromVariations().colors; let last = last">
                  {{ color }}{{ !last ? ', ' : '' }}
                </span>
              </td>
            </tr>

            <!-- Sizes -->
            <tr *ngIf="(getAdditionalInfoFromVariations().sizes).length > 0">
              <th scope="row">Size</th>
              <td class="size-list">
                <span *ngFor="let size of getAdditionalInfoFromVariations().sizes; let last = last">
                  {{ size }}{{ !last ? ', ' : '' }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Reviews Section -->
    <section id="reviews" class="content-section" role="tabpanel" aria-labelledby="reviews-heading" tabindex="0">
      <h2 id="reviews-heading" class="section-header">Reviews</h2>
      <div class="reviews-content">
        <div *ngIf="reviewCount > 0; else noReviews">
          <p>Reviews implementation will be integrated here</p>
        </div>
        <ng-template #noReviews>
          <div class="no-reviews">
            <p>This product has no reviews yet. Be the first to review!</p>
            <button class="add-review-btn">Add a Review</button>
          </div>
        </ng-template>
      </div>
    </section>
  </div>
</div>

<!-- Loading state -->
<div class="loading-description" *ngIf="!productAdditionlInfo" aria-live="polite">
  <p>Loading product description...</p>
</div>