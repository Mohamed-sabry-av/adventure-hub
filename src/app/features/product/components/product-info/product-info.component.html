<div class="product-info">
  <h1 class="text-5xl font-medium text-olive mb-4">{{ productInfo()?.name }}</h1>

  <div class="flex items-baseline mb-4">
    <span class="text-2xl font-bold">{{ getPriceInfo().price }} AED</span>
    <span class="text-gray-500 line-through ml-2" *ngIf="getPriceInfo().isOnSale">
      {{ getPriceInfo().regularPrice }} AED
    </span>
  </div>

  <div class="product-brand" *ngIf="brandName !== 'brand'">
    <span class="brand-label">Brand:</span>
    <a [routerLink]="['/product/brand', brandSlug]" class="brand-link">{{ brandName }}</a>
  </div>

  <!-- Stock Status Message for Completely Out of Stock -->
  <div class="stock-status" *ngIf="isCompletelyOutOfStock">
    <span class="text-red-500 font-medium">Out of Stock</span>
  </div>

  <!-- Variation Selection -->
  <div *ngIf="productInfo()?.type === 'variable' && !isCompletelyOutOfStock">
    <!-- Color Options -->
    @if(getVariationOptions('Color').length){
      <div class="product-option">
        <label class="option-label">Color</label>
        <div class="color-options">
          @for (option of getVariationOptions('Color'); track $index) {
            <div
              class="color-option"
              [class.active]="selectedAttributes['Color'] === option.value"
              [class.out-of-stock]="!option.inStock"
              (click)="option.inStock && selectAttribute('Color', option.value)"
            >
              <div class="color-swatch" [style.background-image]="'url(' + option.image + ')'"></div>
              <span class="color-name">{{ option.value }}</span>
              <span class="out-of-stock-badge" *ngIf="!option.inStock">Out of Stock</span>
            </div>
          }
        </div>
      </div>
    }

    <!-- Size Options (Filtered by Selected Color, including out of stock) -->
    @if(getVariationOptions('Size', selectedAttributes['Color']).length){
      <div class="product-option">
        <label class="option-label">Size</label>
        <div class="size-options">
          @for (option of getVariationOptions('Size', selectedAttributes['Color']); track $index) {
            <div
              class="size-option"
              [class.active]="selectedAttributes['Size'] === option.value"
              [class.out-of-stock]="!option.inStock"
              (click)="option.inStock && selectAttribute('Size', option.value)"
            >
              {{ option.value }}
              <span class="out-of-stock-badge" *ngIf="!option.inStock">Out of Stock</span>
            </div>
          }
        </div>
      </div>
    }
  </div>

  <!-- Prompt to Select Variation -->
  <div *ngIf="!allVariationAttributesSelected && !isCompletelyOutOfStock && productInfo()?.type === 'variable'">
    <span class="text-gray-500">Please select all options to check availability</span>
  </div>

  <!-- Quantity Controls and Add to Cart -->
  <div *ngIf="(allVariationAttributesSelected || productInfo()?.type === 'simple') && isProductInStock">
    <div class="product-option">
      <label class="option-label">Quantity</label>
      <div class="quantity-control">
        <button class="quantity-btn" (click)="onQuantityDown()" [disabled]="quantity <= 1">-</button>
        <span class="quantity-display">{{ quantity }}</span>
        <button class="quantity-btn" (click)="onQuantityUp()" [disabled]="quantity >= maxLength">+</button>
      </div>
      <span class="text-sm text-gray-500 ml-2" *ngIf="maxLength > 0">
        {{ maxLength }} items available
      </span>
    </div>
    <button
      class="w-full bg-orange-500 text-white py-3 font-medium rounded-md mb-3 hover:bg-orange-600 transition-colors"
      (click)="addToCart()"
    >
      ADD TO CART
    </button>
    <button
      class="w-full bg-black text-white py-3 font-medium rounded-md mb-3 flex items-center justify-center"
      (click)="buyNow()"
    >
      Buy Now
    </button>
  </div>

  <!-- Out of Stock for Selected Variation -->
  <div *ngIf="allVariationAttributesSelected && !isProductInStock && !isCompletelyOutOfStock">
    <span class="text-red-500 font-medium">This variation is out of stock</span>
  </div>

  <div class="mt-4 flex items-center gap-x-2 cursor-pointer" [routerLink]="">
    <i class="pi pi-heart text-sm"></i>
    <span class="text-sm font-semibold hover:underline">Add to wishlist</span>
  </div>

  <div *ngIf="isProductInStock" class="bg-gray-50 p-4 rounded-md mb-6 flex items-center justify-between">
    <div>
      <p class="text-sm">4 interest-free payments or as low as <strong>AED {{ (parseFloatValue(getPriceInfo().price) / 10.45).toFixed(2) }}/month</strong></p>
      <p class="text-sm text-gray-500">More options</p>
    </div>
    <img
      src="https://ext.same-assets.com/1752825376/3628814952.png"
      alt="Tabby"
      class="h-8"
    />
  </div>

  <div class="mt-6 flex flex-col gap-y-1">
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> Free Shipping in UAE For orders above AED 100.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> 7 days easy returns.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> Delivery within 1-2 working days.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> World wide shipping.
    </p>
  </div>
</div>