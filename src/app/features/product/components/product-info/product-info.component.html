<div class="product-info">
  <h1 class="text-3xl font-medium text-olive mb-4">
    {{ productInfo()?.name }}
  </h1>

  <div class="flex items-baseline mb-4">
    <span class="text-2xl font-bold" [innerHtml]="getPriceInfo().price | currencySvg"></span>
    <span
      class="text-gray-500 line-through ml-2"
      *ngIf="getPriceInfo().isOnSale"
      [innerHtml]="getPriceInfo().regularPrice | currencySvg"
    ></span>
  </div>

  <div class="product-brand" *ngIf="brandName !== 'brand'">
    <span class="brand-label">Brand:</span>
    <a [routerLink]="['/product/brand', brandSlug]" class="brand-link">{{
      brandName
    }}</a>
  </div>

  <!-- Stock Status Message for Completely Out of Stock -->
  <div class="stock-status" *ngIf="isCompletelyOutOfStock">
    <span class="text-red-500 font-medium">Out of Stock</span>
  </div>

  <!-- Variation Selection -->
  <div *ngIf="productInfo()?.type === 'variable' && !isCompletelyOutOfStock">
    <!-- Color Options -->
    <ng-container *ngIf="getVariationOptions('Color').length">
      <div class="product-option">
        <label class="option-label">Color</label>
        <div class="color-options">
          <div
            *ngFor="let option of getVariationOptions('Color'); let i = index"
            class="color-option"
            [class.active]="selectedAttributes['Color'] === option.value"
            [class.out-of-stock]="!option.inStock"
            (click)="option.inStock && selectAttribute('Color', option.value)"
          >
            <div class="color-swatch" [style.background-image]="'url(' + option.image + ')'" [title]="option.value"></div>
            <span class="color-name">{{ option.value }}</span>
            <span class="out-of-stock-badge" *ngIf="!option.inStock">Out of Stock</span>
          </div>
        </div>
      </div>
    </ng-container>

    <!-- Size Options (Filtered by Selected Color, including out of stock) -->
    <ng-container *ngIf="getVariationOptions('Size', selectedAttributes['Color']).length">
      <div class="product-option">
        <label class="option-label">Size</label>
        <div class="size-options">
          <div
            *ngFor="let option of getVariationOptions('Size', selectedAttributes['Color']); let i = index"
            class="size-option"
            [class.active]="selectedAttributes['Size'] === option.value"
            [class.out-of-stock]="!option.inStock"
            (click)="option.inStock && selectAttribute('Size', option.value)"
          >
            {{ option.value }}
            <span class="out-of-stock-badge" *ngIf="!option.inStock">Out of Stock</span>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <!-- Prompt to Select Variation -->
  <div
    *ngIf="
      !allVariationAttributesSelected &&
      !isCompletelyOutOfStock &&
      productInfo()?.type === 'variable'
    "
  >
    <span class="text-gray-500"
      >Please select all options to check availability</span
    >
  </div>

  <!-- Quantity Controls and Add to Cart / Buy Now Buttons -->
  <div *ngIf="(allVariationAttributesSelected || productInfo()?.type === 'simple') && isProductInStock">
    <div class="product-option">
      <label class="option-label">Quantity</label>
      <div class="quantity-control">
        <button
          class="quantity-btn"
          (click)="onQuantityDown()"
          [disabled]="quantity <= 1"
        >
          -
        </button>
        <span class="quantity-display">{{ quantity }}</span>
        <button
          class="quantity-btn"
          (click)="onQuantityUp()"
          [disabled]="quantity >= maxLength"
        >
          +
        </button>
      </div>
      <span class="text-sm text-gray-500 ml-2" *ngIf="maxLength > 0">
        {{ maxLength }} items available
      </span>
    </div>

    <!-- Cart and Buy Buttons -->
    <div class="flex mt-6 mb-4">
      <div class="action-buttons">
        <button class="cart-btn" (click)="addToCart()">ADD TO CART</button>
        <button class="buy-btn" (click)="buyNow()">BUY IT NOW</button>
      </div>

      <button
        class="wishlist-btn ml-2"
        (click)="addToWishList(productInfo()?.id)"
        [class.active]="isInWishlist"
        [disabled]="isAddingToWishlist"
      >
        <i class="pi pi-heart"></i>
      </button>
    </div>

    <!-- Payment Methods -->
    <div class="payment-options">
      <div class="payment-title">Pay with</div>
      <div class="payment-methods">
        <img src="https://ext.same-assets.com/1752825376/3628814952.png" alt="Tabby" class="payment-icon">
        <img src="https://ext.same-assets.com/1752825376/2635905792.png" alt="Card" class="payment-icon">
        <img src="https://ext.same-assets.com/1687448576/8956612608.png" alt="Google Pay" class="payment-icon">
      </div>
    </div>

    <!-- Social Share Buttons -->
    <div class="social-share">
      <h3 class="share-title">Share Product</h3>
      <div class="share-buttons">
        <a
          [href]="getFacebookShareUrl()"
          target="_blank"
          rel="noopener noreferrer"
          class="share-button facebook"
          aria-label="Share on Facebook"
        >
          <i class="pi pi-facebook"></i>
        </a>
        <a
          [href]="getTwitterShareUrl()"
          target="_blank"
          rel="noopener noreferrer"
          class="share-button twitter"
          aria-label="Share on Twitter"
        >
          <i class="pi pi-twitter"></i>
        </a>
        <a
          [href]="getWhatsAppShareUrl()"
          target="_blank"
          rel="noopener noreferrer"
          class="share-button whatsapp"
          aria-label="Share on WhatsApp"
        >
          <i class="pi pi-whatsapp"></i>
        </a>
        <a (click)="copyProductLink($event)" class="share-button copy-link" aria-label="Copy product link">
          <i class="pi pi-link"></i>
          <span *ngIf="linkCopied" class="copy-toast">Link copied!</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Out of Stock for Selected Variation -->
  <div
    *ngIf="
      allVariationAttributesSelected &&
      !isProductInStock &&
      !isCompletelyOutOfStock
    "
  >
    <span class="text-red-500 font-medium">This variation is out of stock</span>
  </div>

  <!-- Wishlist message -->
  <div
    *ngIf="wishlistMessage"
    class="mt-2 text-sm"
    [class.text-green-500]="wishlistSuccess"
    [class.text-red-500]="!wishlistSuccess"
  >
    {{ wishlistMessage }}
  </div>

  <div
    *ngIf="isProductInStock"
    class="bg-gray-50 p-4 rounded-md mb-6 flex items-center justify-between"
  >
    <div>
      <p class="text-sm">
        4 interest-free payments or as low as
        <strong [innerHtml]="(parseFloatValue(getPriceInfo().price) / 10.45).toFixed(2) | currencySvg"></strong>/month
      </p>
      <p class="text-sm text-gray-500">More options</p>
    </div>
    <img
      src="https://ext.same-assets.com/1752825376/3628814952.png"
      alt="Tabby"
      class="h-8"
    />
  </div>

  <div class="mt-6 flex flex-col gap-y-1">
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> Free Shipping
      in UAE For orders above AED 100.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> 7 days easy
      returns.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> Delivery
      within 1-2 working days.
    </p>
    <p class="text-sm">
      <span><i class="pi pi-check-circle text-sm mr-1"></i></span> World wide
      shipping.
    </p>
  </div>
</div>
