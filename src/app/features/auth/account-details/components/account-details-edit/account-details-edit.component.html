<div class="account-details-content">
    <h2 class="text-2xl font-semibold mb-4">Account Details</h2>
  
    <div *ngIf="isLoading" class="loading p-4 text-center">
      <p>Loading your account details...</p>
      <div class="mt-2 flex justify-center">
        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-gray-800"></div>
      </div>
    </div>
  
    <div *ngIf="error" class="error-message p-4 bg-red-50 text-red-600 rounded mb-6">
      <p>{{ error }}</p>
    </div>
  
    <div *ngIf="saveSuccess" class="success-message p-4 bg-green-50 text-green-600 rounded mb-6">
      <div class="flex items-center">
        <i class="pi pi-check-circle mr-2"></i>
        <p>Your account details have been updated successfully!</p>
      </div>
    </div>
  
    <div *ngIf="!isLoading && !error && customerDetails">
      <!-- Account Information Form -->
      <form [formGroup]="accountForm" (ngSubmit)="saveAccountDetails()" class="account-form">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- First Name -->
          <div class="form-group">
            <label for="first_name" class="block text-sm font-medium mb-1">First Name *</label>
            <input
              type="text"
              id="first_name"
              formControlName="first_name"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': accountForm.get('first_name')?.invalid && accountForm.get('first_name')?.touched}">
            <small *ngIf="accountForm.get('first_name')?.invalid && accountForm.get('first_name')?.touched" class="text-red-500">
              First name is required
            </small>
          </div>
  
          <!-- Last Name -->
          <div class="form-group">
            <label for="last_name" class="block text-sm font-medium mb-1">Last Name *</label>
            <input
              type="text"
              id="last_name"
              formControlName="last_name"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': accountForm.get('last_name')?.invalid && accountForm.get('last_name')?.touched}">
            <small *ngIf="accountForm.get('last_name')?.invalid && accountForm.get('last_name')?.touched" class="text-red-500">
              Last name is required
            </small>
          </div>
  
          <!-- Display Name -->
          <div class="form-group">
            <label for="display_name" class="block text-sm font-medium mb-1">Display Name *</label>
            <input
              type="text"
              id="display_name"
              formControlName="display_name"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
            <small class="text-gray-500 text-xs">This is how your name will be displayed in the account section and in reviews</small>
          </div>
  
          <!-- Email -->
          <div class="form-group">
            <label for="email" class="block text-sm font-medium mb-1">Email Address *</label>
            <input
              type="email"
              id="email"
              formControlName="email"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': accountForm.get('email')?.invalid && accountForm.get('email')?.touched}">
            <small *ngIf="accountForm.get('email')?.invalid && accountForm.get('email')?.touched" class="text-red-500">
              Please enter a valid email address
            </small>
          </div>
        </div>
  
        <div class="mt-6">
          <button
            type="submit"
            [disabled]="accountForm.invalid || isSaving"
            class="px-6 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors"
            [ngClass]="{'opacity-50 cursor-not-allowed': accountForm.invalid || isSaving}">
            <i *ngIf="isSaving" class="pi pi-spinner pi-spin mr-2"></i>
            {{ isSaving ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </form>
  
      <!-- Password Change Section -->
      <div class="password-section mt-12 pt-8 border-t">
        <h3 class="text-xl font-medium mb-4">Change Password</h3>
  
        <button *ngIf="!showPasswordForm" (click)="togglePasswordForm()" class="px-6 py-2 bg-gray-100 rounded hover:bg-gray-200 transition-colors">
          Change Password
        </button>
  
        <form *ngIf="showPasswordForm" [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="password-form mt-4">
          <!-- Current Password -->
          <div class="form-group mb-4">
            <label for="current_password" class="block text-sm font-medium mb-1">Current Password *</label>
            <input
              type="password"
              id="current_password"
              formControlName="current_password"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': passwordForm.get('current_password')?.invalid && passwordForm.get('current_password')?.touched}">
            <small *ngIf="passwordForm.get('current_password')?.invalid && passwordForm.get('current_password')?.touched" class="text-red-500">
              Current password is required
            </small>
          </div>
  
          <!-- New Password -->
          <div class="form-group mb-4">
            <label for="new_password" class="block text-sm font-medium mb-1">New Password *</label>
            <input
              type="password"
              id="new_password"
              formControlName="new_password"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': passwordForm.get('new_password')?.invalid && passwordForm.get('new_password')?.touched}">
            <small *ngIf="passwordForm.get('new_password')?.invalid && passwordForm.get('new_password')?.touched" class="text-red-500">
              New password must be at least 8 characters
            </small>
          </div>
  
          <!-- Confirm Password -->
          <div class="form-group mb-4">
            <label for="confirm_password" class="block text-sm font-medium mb-1">Confirm New Password *</label>
            <input
              type="password"
              id="confirm_password"
              formControlName="confirm_password"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
              [ngClass]="{'border-red-500': (passwordForm.get('confirm_password')?.invalid || passwordForm.hasError('notMatched')) && passwordForm.get('confirm_password')?.touched}">
            <small *ngIf="passwordForm.hasError('notMatched') && passwordForm.get('confirm_password')?.touched" class="text-red-500">
              Passwords do not match
            </small>
          </div>
  
          <div class="mt-4 flex">
            <button
              type="submit"
              [disabled]="passwordForm.invalid || isSaving"
              class="px-6 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition-colors"
              [ngClass]="{'opacity-50 cursor-not-allowed': passwordForm.invalid || isSaving}">
              <i *ngIf="isSaving" class="pi pi-spinner pi-spin mr-2"></i>
              {{ isSaving ? 'Saving...' : 'Change Password' }}
            </button>
            <button
              type="button"
              (click)="togglePasswordForm()"
              class="ml-3 px-6 py-2 border rounded hover:bg-gray-100 transition-colors">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  